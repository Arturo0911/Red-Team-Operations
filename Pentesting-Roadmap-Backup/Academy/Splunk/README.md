# Investigating with Splunk




```bash
`sysmon` process=net.exe (CommandLine="net  view") | stats count by Computer,CommandLine
```



# Intrusion Detection With Splunk (Real-world Scenario)

## Introduction

The Windows Event Logs & Finding Evil module familiarized us with log exploration on a single machine to 
pinpoint malicious activity. Now, we're stepping up our game. We'll be conducting similar investigations, but on a much larger scale, across numerous machines to uncover irregular activities within the entire network instead
of just one device. Our tools will still include Windows Event Logs, but the scope of our work will broaden
significantly, demanding careful scrutiny of a larger pool of information, and identifying and discarding
false positives whenever possible.


## Ingesting Data Sources.

At the start of creating hunts, alerts, or queries, the sheel volume of information and data can be daunting. Part of the start of
beign a cybersecurity professional involves pinpointing the most meaningful data, determinig how to sift through it quickly and efficiently, and ensuring the robustness of our analysis.

To proceed, we need access to data we can analyze and use for threat hunting. There are few sources we can turn to. One source that Splunk provides, along with installation instructions.




```spl
index="main" EventCode=10 TargetImage="C:\\Windows\\System32\\lsass.exe" | stats count by SourceImage
```


Searching over the EventCode=4624 accessed by SYSTEM, with distinct computers
```spl
index=* sourcetype="WinEventLog:Security" EventCode=4624 Account_Name="SYSTEM" 
|  stats dc(ComputerName) as distinct_computer
```

through an SPL search against all 4624 events the account name that made the most login attempts within a span of 10 minutes. Enter it as your answer.


```spl

```
