# Introduction to Host Header Attacks

## HTTP Host Header

The Host header is a mandatory heander since HTTP/1.1 and 
specifies the host targeted by an HTTP request. This is 
particulary important in a sceneario where a web server
runs multiple different web applications and needs to dis-
tinguish between them. Depending on the value of the host 
header in a request, the web server serves a different response
. This is a independent of DNS and allows multiple web
applications to be run on the same IP address and port
(which is either port 80 or 443 by default for web
applications). Since his is common practice, requests 
a valid host header potentially lead to routing issues.


Content Delivery Networks (CDNs) such as Akamai or Cloudflare
also realy on the host header to determine which web 
application to server. While CDNs typically host different
web applications on separate machines, CDN traffic is by
its nature routed over intermediary sistems such as reverse
proxies, web caches, and load balancers. These intermediary 
systems need to know where to forward the traffic whcih
they decide based on the host header in the request.


To demostrate this further, let's have a look at the following
simple Apache configuration for a web serer with two
different virtual hosts:


```bash
<VirtualHost *:80>
    DocumentRoot "/var/www/testapp"
    ServerName testapp.htb
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "/var/www/anotherdomain"
    ServerName anotherdomain.org
</VirtualHost>
```

## Host Header vulnerabilities

Host header vulnerabilities are the result of improper or
unsafe handling of the host header by the web application.
Vulneratble web applications trus the host header without
proper validation os sanitization which can lead to different
vulnerabilities. For instance, since the host header is
user-controllable, it should not be used for authentication 
checks. Improper handling of the host header can thus lead to
authentication bypasses.

Web applications need to know the domain they are hosted on 
to generate absolute links, which are required in different
situations such as password reset links. If the domain is 
not stored in a configuration file and the web application 
uses the host header for generating absolute links without
proper checks, it might be vulnerable to a vulnerability
called **password reset poisoning**


Common override headers

```python
from requests import *
headers-attack = ['X-Forwared-Host', 'X-HTTP-Host-Override', 'Forwarded', 'X-Host', 'X-Forwarded-Server']
```
