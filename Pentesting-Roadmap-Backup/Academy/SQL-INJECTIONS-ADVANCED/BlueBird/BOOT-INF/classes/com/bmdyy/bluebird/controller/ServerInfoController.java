package com.bmdyy.bluebird.controller;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class ServerInfoController {
   @GetMapping({"/server-info"})
   public String serverInfo(Model model) throws IOException {
      Runtime rt = Runtime.getRuntime();
      Process proc = rt.exec(new String[]{"/bin/bash", "/opt/bluebird/serverInfo.sh"});
      BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream()));
      StringBuilder serverInfo = new StringBuilder();

      String line;
      while((line = stdInput.readLine()) != null) {
         serverInfo.append(line).append("\n");
      }

      model.addAttribute("serverInfo", serverInfo);
      return "server-info";
   }
}
