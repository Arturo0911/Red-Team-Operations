#!/usr/bin/python3

# @author: Arturo Negreiros 

import sys
import os
import subprocess
import re

def main():
    
    if len(sys.argv) < 2:
        print("""
        [!] You you have to use python3 locate-system.py <target ip>
                """)
        exit(1)
    
    try:
        process = subprocess.check_output(f"ping -c 1 {sys.argv[1]}", stderr=subprocess.STDOUT, shell=True)
        ttl = process.decode().split()[12]
        response = int(re.findall(r'=(.*)', ttl)[0])

        if response <= 64:
            print(f"[*] The ip target {sys.argv[1]} is a Linux System")
            exit(0)
        elif response == 127 or response == 128:
            print(f"[*] The ip target {sys.argv[1]} if a Windos box")
            exit(0)
            

    except Exception as e:
        print(f"{str(e)}")
        exit(1)



if __name__ == "__main__":
    main()
