#!/usr/bin/python3

from base64 import (
    b64decode,
    b64encode
)
import requests


"""
def bit_flip(pos, bit, data):
	raw = b64decode(data)
	list_1 = list(raw)
	list_1[pos] = chr(ord(list_1[pos]) ^ bit)
	raw = ''.join(list_1)
	return b64encode(raw)
"""


def bitFlip(pos, bit, data):
    raw = b64decode(data)
    list1 = list(raw)
    list1[pos] = chr(ord(list1[pos]) ^ bit)
    raw = ''.join(list1)
    return b64encode(raw)


def main():
    ck = "UXRwUFhtUHBJVXd6NlcvWXVWY3VSaTRkRXNZV1I0dDdJbG5Ba3cxV21jbWRDa1lOYWZWM2dlbUJ5SVFneGhXQ1l1TFNDV1BOZ1FNYzZ5YVZGaDRtRUVOZFRZTExuYkVEb0JQTWxJMDNZbmZ5VlAxV0VqQmVtb21UZ0VqYk1XU20="
    # for x in range(128):
    #     for y in range(128):
    #         c = bit_flip(x, y, ck)
    #         cookies = {'auth_name': c}
    #         ress = requests.get(
    #             url="http://mercury.picoctf.net:10868/", cookies=cookies)
    #         if "picoCTF{" in ress.text:
    #             print(ress.text)
    #             break

    for i in range(128):
        for j in range(128):
            c = bitFlip(i, j, ck)
            cookies = {'auth_name': c}
            r = requests.get('http://mercury.picoctf.net:10868/', cookies=cookies)
            if "picoCTF{" in r.text:
                print(r.text)
                break


if __name__ == "__main__":
    main()
