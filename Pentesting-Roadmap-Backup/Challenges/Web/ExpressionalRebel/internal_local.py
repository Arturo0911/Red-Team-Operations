
"""
got it from the internal_local.py from the 
SSRF
"""



import os
from flask import *
import urllib
import subprocess

basedir = os.path.abspath(os.path.dirname(__file__))

app = Flask(__name__)

def run_command(command):
	p = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
	stdout = p.stdout.read()
	stderr = p.stderr.read()
	result = stdout.decode() + " " + stderr.decode()
	return result

@app.route("/")
def index():
	return run_command("ls -lha")

@app.route("/runme")
def runmewithargs():
	command = request.args.get("x")
	if command == "":
		return "Use /runme?x=<CMD>"
	return run_command(command)

if __name__ == "__main__":
	app.run(host="127.0.0.1", port=5000)