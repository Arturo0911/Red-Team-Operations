#!/usr/bin/python3

"""
Script to know the current operative system is online
Author: Arturo Negreiros

"""

import sys
import subprocess
from pwn import *
import re


def identify_system(ip: str) -> str:
    output = subprocess.Popen(["ping -c 1 %s"%ip], stdout=subprocess.PIPE, shell=True)
    (conn, err) = output.communicate()

    conn = int(re.findall(r'\d{1,3}', conn.decode().split()[12])[0])
    return f"\n\t\t[*] Linux for IP => {ip}" if conn >= 0 and conn <= 64 else f"\n\t\t[*] Windows for IP => {ip}"


def main():
    #try:
    if len(sys.argv) < 2:
        raise ValueError("\n\t\t[*] Use python3 whatSystemIs.py <ip>")
    main_ip = sys.argv[1]
    print(identify_system(main_ip))



if __name__ == "__main__":
    main()
