# Ransom machine


### Enumeration:
  - In the basic numeration, we will find the typical ports open SSH and Http

### Exploring content:
  - We will find a simple login, saying, input only the password but, trying different methods
    to get the access, but using this simple request

    ```
    GET /api/login

    Content-Type: application/json

    {
      "password":true
    }
    ```

  - Why "true" ?
    Well, there are a simple intrusion using a comparision "Type Juggling" is the intrusion method
    to get forward with a simple bypass.


### Intrusion:
  - First trying to get access to the machine, after the bypassing
    in the loging, you can download a zip file, with the following
    content: 
      - .bash_logout
      - .ssh/
      - etc
  
  - And also, these files are encrypted, and the only method it's
    trying crack the password, but, thanks to God there are an 
    article with the explanation about the cracking the conti
    ransomware 
    ```
    https://medium.com/@whickey000/how-i-cracked-conti-ransomware-groups-leaked-source-code-zip-file-e15d54663a8
    ```
  - First using the condition, to use bkcrack "almost must be there
    a similar file with the same size to get the cracking" and as the
    .bash_logout it's to similar to many other Linux distributions, 
    we choose the .bash_logout to get the cracking
  - using the following commands:
    ```
    ./bkcrack -C uploaded-file-3422.zip -c .bash_logout -P bash_logout.zip -p .bash_logout
    ```
    This should be generate  a three keys for the uncracking

    ```
    ./bkcrack -C uploaded-file-3422.zip -k <three previous keys> -U unlocked.zip password
    ```

  - Once you can uncrack the content, make chmod 600 to id_rsa key
    and connect as htb@<ip>

### Privilege scalation:

  - Once you make the session using SSH, there are two ways to get 
    the root access, because the user HTB it's on the sudoers group
  
  - the application it isn't in the common path */var/www/html*
    but using the ```cat /etc/apache2/sites_enabled/conf...```
    you can find the right path.

    And using the greping command to find the comparision of the
    password of the login, you can find the comparasion in the AuthController with find \-name *AuthController*
  
  - Once you get the password, use sudo root and get the flag :)