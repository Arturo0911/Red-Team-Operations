from datetime import datetime, timedelta
import jwt

JWT_SECRET = 'jwtsecretkey10981'
JWT_ALGORITHM = 'HS256'
JWT_EXP_DELTA_SECONDS = 10000

def token(username):
    payload = {
        'user_id': username,
        'exp': datetime.utcnow() + timedelta(seconds=JWT_EXP_DELTA_SECONDS)
    }
    jwt_token = jwt.encode(payload, JWT_SECRET, JWT_ALGORITHM)
    return jwt_token


def authorization(token):
    if token:
        try:
            payload = jwt.decode(token, JWT_SECRET,
                                 algorithms=[JWT_ALGORITHM])
            return True
        except (jwt.DecodeError, jwt.ExpiredSignatureError):
            return False
