#!/usr/bin/python3

import requests


def check(url: str, port: int) -> bool:
    check_path = '/securityRealm/user/admin/search/index'
    check_params = {'q': 'a'}
    vulnerable = False
    r = requests.get(url + ':' + str(port) + check_path, params=check_params)
    if 'HTTP ERROR 404' not in r.text:
        print("[*] Likelly VULNERABLE")
        print(r.url)
        vulnerable = True
    else:
        print(r.status_code)
        print("[_] Target doesnt seem vulnerable...")

    return vulnerable

check("http://10.10.10.63/askjeeves", 50000)
